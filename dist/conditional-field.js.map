{"version":3,"sources":["conditional-field.js"],"names":["ConditionalField","args","$control","$","control","length","inputType","getInputType","setVisible","inputValue","onChangeBound","onChange","bind","on","e","value","shown","controlValue","visibility","selectors","Array","isArray","join","show","hide","res","filter","indexOf","item","is","val","off"],"mappings":";;;;;;;;IAAMA,gB;AACJ,4BAAYC,IAAZ,EAAiB;AAAA;;AACf,SAAKC,QAAL,GAAgBC,EAAEF,KAAKG,OAAP,CAAhB;;AAEA,QAAG,KAAKF,QAAL,CAAcG,MAAd,IAAwB,CAA3B,EAA8B;;AAE9B,SAAKJ,IAAL,GAAYA,IAAZ;AACA,SAAKK,SAAL,GAAiB,KAAKC,YAAL,EAAjB;AACA,SAAKC,UAAL,CAAgB,KAAKC,UAAL,EAAhB;;AAEA,SAAKC,aAAL,GAAqB,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAArB;AACA,SAAKV,QAAL,CAAcW,EAAd,CAAiB,QAAjB,EAA2B,KAAKH,aAAhC;AACD;;;;6BAEQI,C,EAAG;AACV,UAAIC,QAAQ,KAAKN,UAAL,EAAZ;AACA,WAAKD,UAAL,CAAgBO,KAAhB;AACD;;;+BAEUA,K,EAAO;;AAEhB,UAAIC,QAAQ,EAAZ;AACA,WAAI,IAAIC,YAAR,IAAwB,KAAKhB,IAAL,CAAUiB,UAAlC,EAA6C;;AAE3C,YAAMC,YAAYC,MAAMC,OAAN,CAAc,KAAKpB,IAAL,CAAUiB,UAAV,CAAqBD,YAArB,CAAd,IAAoD,KAAKhB,IAAL,CAAUiB,UAAV,CAAqBD,YAArB,CAApD,GAAyF,CAAC,KAAKhB,IAAL,CAAUiB,UAAV,CAAqBD,YAArB,CAAD,CAA3G;AACA,YAAGF,UAAUE,YAAb,EAA0B;AACxBD,+CAAYA,KAAZ,sBAAsBG,SAAtB;AACAhB,YAAEgB,UAAUG,IAAV,CAAe,GAAf,CAAF,EAAuBC,IAAvB;AACD,SAHD,MAGK;;AAEH,cAAGP,MAAMX,MAAN,KAAiB,CAApB,EAAsB;AACpBF,cAAEgB,UAAUG,IAAV,CAAe,GAAf,CAAF,EAAuBE,IAAvB;AACA;AACD;;AAED;AACA,cAAMC,MAAMN,UAAUO,MAAV,CAAiB;AAAA,mBAAQV,MAAMW,OAAN,CAAcC,IAAd,MAAwB,CAAC,CAAjC;AAAA,WAAjB,CAAZ;AACAzB,YAAEsB,IAAIH,IAAJ,CAAS,GAAT,CAAF,EAAiBE,IAAjB;AACD;AACF;AACF;;;mCAEc;AACb,UAAG,KAAKtB,QAAL,CAAc2B,EAAd,CAAiB,QAAjB,CAAH,EAA8B;AAC5B,eAAO,QAAP;AACD,OAFD,MAEM,IAAG,KAAK3B,QAAL,CAAc2B,EAAd,CAAiB,QAAjB,CAAH,EAA8B;AAClC,eAAO,OAAP;AACD,OAFK,MAEA,IAAG,KAAK3B,QAAL,CAAc2B,EAAd,CAAiB,WAAjB,CAAH,EAAiC;AACrC,eAAO,UAAP;AACD;AACF;;;iCAEY;AACX,UAAId,QAAQ,EAAZ;AACA,cAAO,KAAKT,SAAZ;AACE,aAAK,UAAL;AACES,kBAAQ,KAAKb,QAAL,CAAc2B,EAAd,CAAiB,UAAjB,IAA+B,IAA/B,GAAsC,KAA9C;AACA;AACF,aAAK,OAAL;AACEd,kBAAQ,KAAKb,QAAL,CAAcwB,MAAd,CAAqB,UAArB,EAAiCI,GAAjC,EAAR;AACA;AACF;AACEf,kBAAQ,KAAKb,QAAL,CAAc4B,GAAd,EAAR;AARJ;AAUA,aAAOf,KAAP;AACD;;;8BAES;AACR,WAAKb,QAAL,CAAc6B,GAAd,CAAkB,QAAlB,EAA4B,KAAKrB,aAAjC;AACD","file":"conditional-field.js","sourcesContent":["class ConditionalField {\n  constructor(args){\n    this.$control = $(args.control);\n\n    if(this.$control.length == 0) return;\n\n    this.args = args;\n    this.inputType = this.getInputType();\n    this.setVisible(this.inputValue());\n\n    this.onChangeBound = this.onChange.bind(this);\n    this.$control.on('change', this.onChangeBound);\n  }\n\n  onChange(e) {\n    var value = this.inputValue();\n    this.setVisible(value);\n  }\n\n  setVisible(value) {\n    \n    let shown = [];\n    for(let controlValue in this.args.visibility){\n      \n      const selectors = Array.isArray(this.args.visibility[controlValue]) ? this.args.visibility[controlValue] : [this.args.visibility[controlValue]];\n      if(value === controlValue){\n        shown = [...shown, ...selectors];\n        $(selectors.join(',')).show();\n      }else{\n      \n        if(shown.length === 0){\n          $(selectors.join(',')).hide();\n          continue;\n        }\n\n        // filter out elements that are already shown\n        const res = selectors.filter(item => shown.indexOf(item) === -1);\n        $(res.join(',')).hide();\n      }\n    }\n  }\n\n  getInputType() {\n    if(this.$control.is('select')){\n      return 'select';\n    }else if(this.$control.is(':radio')){\n      return 'radio';\n    }else if(this.$control.is(':checkbox')){\n      return 'checkbox';\n    }\n  }\n\n  inputValue() {\n    let value = '';\n    switch(this.inputType){\n      case 'checkbox':\n        value = this.$control.is(':checked') ? 'on' : 'off';\n        break;\n      case 'radio':\n        value = this.$control.filter(':checked').val();\n        break;\n      default:\n        value = this.$control.val();\n    }\n    return value;\n  }\n\n  destroy() {\n    this.$control.off('change', this.onChangeBound);\n  }\n}"]}